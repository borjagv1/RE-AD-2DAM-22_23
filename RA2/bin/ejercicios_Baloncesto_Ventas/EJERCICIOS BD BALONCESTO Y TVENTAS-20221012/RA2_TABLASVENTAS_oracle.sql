/* ELIMINO TABLAS */
/* USUARIO Y CLAVE UNIDAD2*/
DROP TABLE TLINEASVENTAS;
DROP TABLE TVENTAS;
DROP TABLE TCLIENTES;
DROP TABLE TPRODUCTOS;

/* CREO TABLAS */

CREATE TABLE  TCLIENTES (
  IDCLIENTE  VARCHAR(4) ,
  NOMBRE     VARCHAR(50),
  DIRECCION  VARCHAR(50),
  POBLACION  VARCHAR(50),
  CODPOSTAL  VARCHAR(5),
  PROVINCIA  VARCHAR(40),
  NIF        VARCHAR(9) UNIQUE,
  TELEFONO1  VARCHAR(15),
  TELEFONO2  VARCHAR(15),
  TELEFONO3  VARCHAR(15),
   constraint PK_cli PRIMARY KEY(IDCLIENTE)
);

CREATE TABLE TPRODUCTOS (
  IDPRODUCTO  VARCHAR(4) ,
  DESCRIPCION VARCHAR(80),
  PVP   number(6,2),
  STOCKACTUAL number(3),
  STOCKMINIMO number(3),
  constraint PK_PRO PRIMARY KEY(IDPRODUCTO)
  );
  
 CREATE TABLE TVENTAS(
  IDVENTA     VARCHAR(4),
  IDCLIENTE   VARCHAR(4) NOT NULL,
  FECHAVENTA  DATE  ,
  constraint PK_VEN1 PRIMARY KEY(IDVENTA),
  CONSTRAINT FK_VEN1 FOREIGN KEY (IDCLIENTE) REFERENCES TCLIENTES(IDCLIENTE)
);

CREATE TABLE TLINEASVENTAS (  
  IDVENTA       VARCHAR(4),
  NUMEROLINEA   number(3),
  IDPRODUCTO    VARCHAR(4),
  CANTIDAD      number(3), 
  CONSTRAINT FK_LV1 FOREIGN KEY (IDVENTA) REFERENCES TVENTAS (IDVENTA),
  CONSTRAINT FK_LV2 FOREIGN KEY (IDPRODUCTO) REFERENCES TPRODUCTOS(IDPRODUCTO),  
  constraint PK_LV PRIMARY KEY (IDVENTA,NUMEROLINEA)
);


/* insercion de datos EJEMPLO */

INSERT INTO TCLIENTES VALUES 
('C001', 'Luis Gracia','C/Las Flores 23', 'Guadalajara', '19003', 'Guadalajara', 
 '34343434L',  '949876655', '949876655','999665544');

INSERT INTO TCLIENTES VALUES 
('C009', 'Ana Serrano','C/Galiana 6', 'Guadalajara',  '19004', 'Guadalajara', 
  '76767667F', '94980009', '999000000', '786908976');

INSERT INTO TPRODUCTOS VALUES ('P001', 'CAJA DE CRISTAL DE MURANO', 100, 25,4);
INSERT INTO TPRODUCTOS VALUES ('AB02', 'BICICLETA CITY', 120, 15,2);
INSERT INTO TPRODUCTOS VALUES ('3009', '100 LÁPICES DE COLORES', 20, 35, 3);
INSERT INTO TPRODUCTOS VALUES ('B400', 'OPERACIONES CON BD', 25, 5, 1);
INSERT INTO TPRODUCTOS VALUES ('B555', 'APLICACIONES WEB', 25.50, 10, 2);
INSERT INTO TPRODUCTOS VALUES ('BZ00', 'TABLET BQ AQUARIS', 250.50, 100,5);
INSERT INTO TPRODUCTOS VALUES ('4055', 'GAFAS RAY BAN', 35.50, 40,5);


/* inserta VARIAS VENTAS PARA EL CLIENTE C001 */
INSERT INTO TVENTAS VALUES('V100','C001', sysdate - 10);
INSERT INTO TVENTAS VALUES('V110','C001', sysdate - 5);
INSERT INTO TVENTAS VALUES('V101','C001', sysdate);

/* INSERTA  LINEAS DE VENTA PARA EL CLIENTE C001 */

INSERT INTO TLINEASVENTAS VALUES ('V100', 1, 'P001', 10);
INSERT INTO TLINEASVENTAS VALUES ('V100', 2, 'B555', 2);
INSERT INTO TLINEASVENTAS VALUES ('V100', 3, 'AB02', 3);
INSERT INTO TLINEASVENTAS VALUES ('V100', 4, '3009', 5);

INSERT INTO TLINEASVENTAS VALUES ('V110', 1, 'B400', 4);
INSERT INTO TLINEASVENTAS VALUES ('V110', 2, '4055', 1);

INSERT INTO TLINEASVENTAS VALUES ('V101', 1, '3009', 2);
INSERT INTO TLINEASVENTAS VALUES ('V101', 2, 'BZ00', 2);
INSERT INTO TLINEASVENTAS VALUES ('V101', 3, 'AB02', 3);

/* inserta VARIAS VENTAS PARA EL CLIENTE C009 */

INSERT INTO TVENTAS VALUES('V200','C009', sysdate - 4);
INSERT INTO TVENTAS VALUES('V120','C009', sysdate );


/* INSERTA  LINEAS DE VENTA PARA EL CLIENTE C009 */

INSERT INTO TLINEASVENTAS VALUES ('V200', 1, 'P001', 2);
INSERT INTO TLINEASVENTAS VALUES ('V200', 2, 'B555', 1);

INSERT INTO TLINEASVENTAS VALUES ('V120', 1, 'AB02', 2);
INSERT INTO TLINEASVENTAS VALUES ('V120', 2, 'BZ00', 4);
INSERT INTO TLINEASVENTAS VALUES ('V120', 3, '4055', 5);

COMMIT;




